var e=require("fs"),t=require("path"),n=require("os"),r=require("playwright-core"),o=require("https"),i=require("node-stream-zip");function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function s(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,t}var c=/*#__PURE__*/s(e),l=/*#__PURE__*/u(e),a=/*#__PURE__*/s(t),f=/*#__PURE__*/s(n),h=/*#__PURE__*/u(n),m=/*#__PURE__*/u(r),v=/*#__PURE__*/u(i);function d(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,P(e,t)}function P(e,t){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},P(e,t)}function p(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(n=i[r])>=0||(o[n]=e[n]);return o}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}const w="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function b(e,t,n){if(!e.s){if(n instanceof k){if(!n.s)return void(n.o=b.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(b.bind(null,e,t),b.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}var k=/*#__PURE__*/function(){function e(){}return e.prototype.then=function(t,n){var r=new e,o=this.s;if(o){var i=1&o?t:n;if(i){try{b(r,1,i(this.v))}catch(e){b(r,2,e)}return r}return this}return this.o=function(e){try{var o=e.v;1&e.s?b(r,1,t?t(o):o):n?b(r,1,n(o)):b(r,2,o)}catch(e){b(r,2,e)}},r},e}();function T(e){return e instanceof k&&1&e.s}var j=function(e,t){return function(n,r){void 0===r&&(r=t);try{var o=function(e,t,n){if("function"==typeof e[w]){var r,o,i,u=e[w]();if(function e(n){try{for(;!(r=u.next()).done;)if((n=t(r.value))&&n.then){if(!T(n))return void n.then(e,i||(i=b.bind(null,o=new k,2)));n=n.v}o?b(o,1,n):o=n}catch(e){b(o||(o=new k),2,e)}}(),u.return){var s=function(e){try{r.done||u.return()}catch(e){}return e};if(o&&o.then)return o.then(s,function(e){throw s(e)});s()}return o}if(!("length"in e))throw new TypeError("Object is not iterable");for(var c=[],l=0;l<e.length;l++)c.push(e[l]);return function(e,t,n){var r,o,i=-1;return function n(u){try{for(;++i<e.length;)if((u=t(i))&&u.then){if(!T(u))return void u.then(n,o||(o=b.bind(null,r=new k,2)));u=u.v}r?b(r,1,u):r=u}catch(e){b(r||(r=new k),2,e)}}(),r}(c,function(e){return t(c[e])})}(r,function(t){return Promise.resolve(t(e,n)).then(function(){})});return Promise.resolve(o&&o.then?o.then(function(){}):void 0)}catch(e){return Promise.reject(e)}}},S=function(e,t){if(e===t)return!1;for(var n=e.replace(/[^\d.-]/g,"").split("."),r=t.replace(/[^\d.-]/g,"").split("."),o=n.length>r.length?n.length:r.length,i=0;i<o;i++)if((Number(n[i])||0)!==(Number(r[i])||0))return(Number(r[i])||0)>(Number(n[i])||0);return!0},B=function(e){return 0===c.readdirSync(e,{withFileTypes:!0}).filter(function(e){return e.isFile()&&!e.name.startsWith(".")}).length},I=function(e,t,n){return function(r){try{var o,i=r.version,u=function(){if(i)return console.log(""),"latest"===i?console.warn("[33m%s[0m","It is not recommended to run "+e+' with "latest" version. Use it at your own risk or set to the recommended version "'+n+'".'):S(n,i)?console.warn("[33m%s[0m","Seems you are running a newer version ("+i+") of "+e+' than recommended by the Dappwright team.\n      Use it at your own risk or set to the recommended version "'+n+'".'):S(i,n)?console.warn("[33m%s[0m","Seems you are running an older version ("+i+") of "+e+' than recommended by the Dappwright team.\n      Use it at your own risk or set the recommended version "'+n+'".'):console.log("Running tests on "+e+" version "+i),console.log(""),Promise.resolve(x(i,t,F(e))).then(function(e){o=e});console.log("Running tests on local "+e+" build")}();return Promise.resolve(u&&u.then?u.then(function(){return o}):o)}catch(e){return Promise.reject(e)}}},F=function(e){return a.resolve(f.tmpdir(),"dappwright",e)},x=function(e,t,n){try{var r=a.resolve(n,e.replace(/\./g,"_"));return"latest"!==e&&c.existsSync(r)&&!B(r)?Promise.resolve(r):(console.log("Downloading extension..."),Promise.resolve(N(t,"v"+e)).then(function(e){var t=e.filename,o=e.downloadUrl;c.existsSync(r)&&B(r)&&c.rmdirSync(r,{recursive:!0});var i=function(){if(!c.existsSync(r)||B(r))return Promise.resolve(A(t,o,n)).then(function(e){var t=new v.default.async({file:e});return c.mkdirSync(r),Promise.resolve(t.extract(null,r)).then(function(){var e=a.resolve(r,"manifest.json"),t=JSON.parse(c.readFileSync(e,"utf-8"));t.key="MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAnpiOcYGaEp02v5On5luCk/4g9j+ujgWeGlpZVibaSz6kUlyiZvcVNIIUXR568uv5NrEi5+j9+HbzshLALhCn9S43E7Ha6Xkdxs3kOEPBu8FRNwFh2S7ivVr6ixnl2FCGwfkP1S1r7k665eC1/xYdJKGCc8UByfSw24Rtl5odUqZX1SaE6CsQEMymCFcWhpE3fV+LZ6RWWJ63Zm1ac5KmKzXdj7wZzN3onI0Csc8riBZ0AujkThJmCR8tZt2PkVUDX9exa0XkJb79pe0Ken5Bt2jylJhmQB7R3N1pVNhNQt17Sytnwz6zG2YsB2XNd/1VYJe52cPNJc7zvhQJpHjh5QIDAQAB",c.writeFileSync(e,JSON.stringify(t))})})}();return i&&i.then?i.then(function(){return r}):r}))}catch(e){return Promise.reject(e)}},A=function(e,t,n){return new Promise(function(r){try{c.existsSync(n)||c.mkdirSync(n,{recursive:!0});var i=a.join(n,e),u=c.createWriteStream(i);return Promise.resolve(function(e){return new Promise(function(t){o.get(e,function(e){302==e.statusCode?o.get(e.headers.location,t).on("error",function(e){throw console.warn("request redirected error:",e.message),e}):t(e)}).on("error",function(e){throw console.warn("request error:",e.message),e})})}(t)).then(function(e){e.pipe(u),e.on("end",function(){r(i)})})}catch(e){return Promise.reject(e)}})},N=function(e,t){return new Promise(function(n,r){var i={headers:{"User-Agent":"Mozilla/5.0"}};process.env.GITHUB_TOKEN&&(i.headers.Authorization="Bearer "+process.env.GITHUB_TOKEN),o.get(e,i,function(e){var o="";e.on("data",function(e){o+=e}),e.on("end",function(){var e=JSON.parse(o);if(e.message)return r(e.message);for(var i,u=g(e);!(i=u()).done;){var s=i.value;if(!s.draft&&("latest"===t||s.name.includes(t)||s.tag_name.includes(t)))for(var c,l=g(s.assets);!(c=l()).done;){var a=c.value;a.name.includes("chrome")&&n({downloadUrl:a.browser_download_url,filename:a.name,tag:s.tag_name})}}r("Version "+t+" not found!")})}).on("error",function(e){throw console.warn("getGithubRelease error:",e.message),e})})},C=function(e){this.version=void 0,this.page=void 0,this.page=e};C.id=void 0,C.recommendedVersion=void 0,C.releasesUrl=void 0,C.homePath=void 0,C.download=void 0;var _=function(e){try{return Promise.resolve(e.waitForTimeout(3e3)).then(function(){})}catch(e){return Promise.reject(e)}},E=function(e,t,n){try{return Promise.resolve(V(e,t,n)).then(function(e){return Promise.resolve(e.click()).then(function(){})})}catch(e){return Promise.reject(e)}},O=function(e,t){try{return Promise.resolve(V(e,t,"button")).then(function(e){return Promise.resolve(e.click()).then(function(){})})}catch(e){return Promise.reject(e)}},U=function(e,t,n,r,o,i){void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===i&&(i=!1);try{var u,s,c=function(t){if(u)return t;function o(){return Promise.resolve(s.type(n)).then(function(){return!0})}var i=function(){if(r)return Promise.resolve(e.evaluate(function(e){e.value=""},s)).then(function(){})}();return i&&i.then?i.then(o):o()},l=function(n,r){try{var i=Promise.resolve(L(e,t,o,5e3)).then(function(e){s=e})}catch(e){return r(e)}return i&&i.then?i.then(void 0,r):i}(0,function(e){if(i)return u=1,!1;throw e});return Promise.resolve(l&&l.then?l.then(c):c(l))}catch(e){return Promise.reject(e)}},V=function(e,t,n){return void 0===n&&(n="*"),e.waitForSelector("//"+n+"[contains(text(), '"+t+"')]")},L=function(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=2e3),e.waitForSelector(["//label[contains(.,'"+t+"')]/following-sibling::textarea","//label[contains(.,'"+t+"')]/following-sibling::*//input","//h6[contains(.,'"+t+"')]/parent::node()/parent::node()/following-sibling::input","//h6[contains(.,'"+t+"')]/parent::node()/parent::node()/following-sibling::*//input"].concat(n?[]:["//span[contains(.,'"+t+"')]/parent::node()/parent::node()/following-sibling::*//input","//span[contains(.,'"+t+"')]/following-sibling::*//input"]).join("|"),{timeout:r})},q=function(e,t){try{return Promise.resolve(W(e,t)).then(function(e){return Promise.resolve(e.click()).then(function(){})})}catch(e){return Promise.reject(e)}},R=function(e){try{return Promise.resolve(e.waitForSelector(".network-display")).then(function(t){return Promise.resolve(t.click()).then(function(){return Promise.resolve(e.waitForSelector("li.dropdown-menu-item")).then(function(){})})})}catch(e){return Promise.reject(e)}},z=function(e){try{return Promise.resolve(e.waitForSelector(".account-menu__icon")).then(function(e){return Promise.resolve(e.click({noWaitAfter:!0,force:!0})).then(function(){})})}catch(e){return Promise.reject(e)}},G=function(e){try{return Promise.resolve(e.waitForSelector(".app-header__logo-container")).then(function(e){return Promise.resolve(e.click()).then(function(){})})}catch(e){return Promise.reject(e)}},W=function(e,t){return e.waitForSelector(["//span[contains(.,'"+t+"')]/parent::div/following-sibling::div/div/div/div","//span[contains(.,'"+t+"')]/parent::div/following-sibling::div/div/label/div"].join("|"))},J=function(e){try{var t={timeout:1e3};return Promise.resolve(Promise.race([e.waitForSelector("span.error",t),e.waitForSelector(".typography--color-error-1",t),e.waitForSelector(".typography--color-error-default",t),e.waitForSelector(".form-field__input--error",t)]).catch(function(){return null})).then(function(e){return!!e&&e.innerText})}catch(e){return Promise.reject(e)}},K=function(e){return function(t){var n=t.networkName,r=t.rpc,o=t.chainId,i=t.symbol;try{return Promise.resolve(e.bringToFront()).then(function(){return Promise.resolve(R(e)).then(function(){return Promise.resolve(O(e,"Add network")).then(function(){return Promise.resolve(e.getByTestId("network-display").click()).then(function(){return Promise.resolve(e.getByRole("button",{name:"Add network"}).click()).then(function(){return Promise.resolve(e.getByTestId("add-network-manually").click()).then(function(){return Promise.resolve(e.getByLabel("Network name").fill(n)).then(function(){return Promise.resolve(e.getByLabel("New RPC URL").fill(r)).then(function(){return Promise.resolve(e.getByLabel("Chain ID").fill(String(o))).then(function(){return Promise.resolve(e.getByLabel("Currency symbol").fill(i)).then(function(){return Promise.resolve(J(e)).then(function(t){function r(t){return Promise.resolve(O(e,"Save")).then(function(){return Promise.resolve(e.waitForSelector("//*[text() = '"+n+"']")).then(function(){return Promise.resolve(e.isVisible("//button[contains(text(), 'Got it')]")).then(function(t){var n=function(){if(t)return Promise.resolve(O(e,"Got it")).then(function(){})}();if(n&&n.then)return n.then(function(){})})})})}var o=function(){if(t)return Promise.resolve(G(e)).then(function(){throw new SyntaxError(t)})}();return o&&o.then?o.then(r):r()})})})})})})})})})})})}catch(e){return Promise.reject(e)}}},D=function(e){return function(t){var n=t.tokenAddress,r=t.symbol,o=t.decimals,i=void 0===o?0:o;try{return Promise.resolve(e.bringToFront()).then(function(){return Promise.resolve(E(e,"Import tokens")).then(function(){return Promise.resolve(e.waitForTimeout(500)).then(function(){return Promise.resolve(O(e,"Custom token")).then(function(){return Promise.resolve(U(e,"Token contract address",n)).then(function(){function t(){return Promise.resolve(L(e,"Token decimal")).then(function(t){return Promise.resolve(t.isDisabled()).then(function(n){function r(){return Promise.resolve(O(e,"Add custom token")).then(function(){return Promise.resolve(O(e,"Import tokens")).then(function(){})})}var o=function(){if(!n)return Promise.resolve(t.type(String(i))).then(function(){})}();return o&&o.then?o.then(r):r()})})}var n=function(){if(r)return Promise.resolve(U(e,"Token symbol",r,!0)).then(function(){})}();return n&&n.then?n.then(t):t()})})})})})}catch(e){return Promise.reject(e)}}},Q=function(e,t){try{return Promise.resolve(e.context().waitForEvent("page")).then(function(e){return Promise.resolve(t(e)).then(function(){var t=function(){if(!e.isClosed())return Promise.resolve(e.waitForEvent("close")).then(function(){})}();if(t&&t.then)return t.then(function(){})})})}catch(e){return Promise.reject(e)}},M=function(e){return function(){try{return Promise.resolve(Q(e,function(t){try{return Promise.resolve(t.waitForLoadState()).then(function(){return Promise.resolve(t.bringToFront()).then(function(){return Promise.resolve(t.locator('input[type="checkbox"]').first().check()).then(function(){return Promise.resolve(O(t,"Next")).then(function(){return Promise.resolve(O(t,"Connect")).then(function(){return Promise.resolve(_(e)).then(function(){return Promise.resolve(t.close()).then(function(){})})})})})})})}catch(e){return Promise.reject(e)}})).then(function(){})}catch(e){return Promise.reject(e)}}},Z=function(e){return function(t){try{return Promise.resolve(Q(e,function(e){try{var n=function(){return Promise.resolve(e.getByTestId("page-container-footer-next").click()).then(function(){})},r=function(){if(t)return Promise.resolve(e.getByTestId("edit-gas-fee-button").click()).then(function(){return Promise.resolve(e.getByTestId("edit-gas-fee-item-custom").click()).then(function(){function n(){function n(){function n(){return Promise.resolve(e.getByRole("button",{name:"Save"}).click()).then(function(){})}var r=function(){if(t.gasLimit)return Promise.resolve(e.getByTestId("advanced-gas-fee-edit").click()).then(function(){return Promise.resolve(e.getByTestId("gas-limit-input").fill(String(t.gasLimit))).then(function(){})})}();return r&&r.then?r.then(n):n()}var r=function(){if(t.priority)return Promise.resolve(e.getByTestId("priority-fee-input").fill(String(t.priority))).then(function(){})}();return r&&r.then?r.then(n):n()}var r=function(){if(t.gas)return Promise.resolve(e.getByTestId("base-fee-input").fill(String(t.gas))).then(function(){})}();return r&&r.then?r.then(n):n()})})}();return Promise.resolve(r&&r.then?r.then(n):n())}catch(e){return Promise.reject(e)}})).then(function(){})}catch(e){return Promise.reject(e)}}},X=function(e){return function(){try{return Promise.resolve(e.bringToFront()).then(function(){return Promise.resolve(z(e)).then(function(){return Promise.resolve(E(e,"Create account")).then(function(){return Promise.resolve(O(e,"Create")).then(function(){return Promise.resolve(_(e)).then(function(){})})})})})}catch(e){return Promise.reject(e)}}},$=function(e){return function(t){try{return Promise.resolve(e.bringToFront()).then(function(){return Promise.resolve(e.waitForTimeout(500)).then(function(){return Promise.resolve(z(e)).then(function(){return Promise.resolve(E(e,"Account "+t)).then(function(){})})})})}catch(e){return Promise.reject(e)}}},H=function(e){return function(t){try{return Promise.resolve(e.bringToFront()).then(function(){if(1===t)throw new SyntaxError("Account 1 cannot be deleted");return Promise.resolve($(e)(t)).then(function(){return Promise.resolve(function(e){try{return Promise.resolve(function(e){return e.waitForSelector("button.menu-bar__account-options")}(e)).then(function(t){return Promise.resolve(t.click()).then(function(){return Promise.resolve(e.waitForSelector(".menu__container.account-options-menu")).then(function(){})})})}catch(e){return Promise.reject(e)}}(e)).then(function(){return Promise.resolve(E(e,"Remove account")).then(function(){return Promise.resolve(O(e,"Remove")).then(function(){return Promise.resolve(_(e)).then(function(){})})})})})})}catch(e){return Promise.reject(e)}}},Y=function(e){return function(t){try{return Promise.resolve(e.bringToFront()).then(function(){return Promise.resolve(R(e)).then(function(){return Promise.resolve(V(e,t)).then(function(n){return Promise.resolve(n.hover()).then(function(){return Promise.resolve(e.waitForSelector("//*[contains(text(), '"+t+"')]/following-sibling::i")).then(function(t){return Promise.resolve(t.click()).then(function(){return Promise.resolve(O(e,"Delete")).then(function(){return Promise.resolve(G(e)).then(function(){})})})})})})})})}catch(e){return Promise.reject(e)}}};function ee(e,t,n){if(!e.s){if(n instanceof te){if(!n.s)return void(n.o=ee.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(ee.bind(null,e,t),ee.bind(null,e,2));e.s=t,e.v=n;const r=e.o;r&&r(e)}}var te=/*#__PURE__*/function(){function e(){}return e.prototype.then=function(t,n){var r=new e,o=this.s;if(o){var i=1&o?t:n;if(i){try{ee(r,1,i(this.v))}catch(e){ee(r,2,e)}return r}return this}return this.o=function(e){try{var o=e.v;1&e.s?ee(r,1,t?t(o):o):n?ee(r,1,n(o)):ee(r,2,o)}catch(e){ee(r,2,e)}},r},e}(),ne=function(e){return function(t){try{return Promise.resolve(e.bringToFront()).then(function(){return Promise.resolve(e.waitForTimeout(1e3)).then(function(){return Promise.resolve(e.$$(".asset-list-item__token-button")).then(function(n){var r,o,i,u,s,c,l,a=(o=n,i=function(o){return Promise.resolve(e.evaluate(function(e){return e.getAttribute("title")},n[o])).then(function(e){if(e.split(" ")[1].toUpperCase()===t.toUpperCase()){var n=e.split(" ")[0],o=parseFloat(n);return r=1,o}})},u=function(){return r},l=-1,function e(t){try{for(;++l<o.length&&(!u||!u());)if((t=i(l))&&t.then){if(!((n=t)instanceof te&&1&n.s))return void t.then(e,c||(c=ee.bind(null,s=new te,2)));t=t.v}s?ee(s,1,t):s=t}catch(e){ee(s||(s=new te),2,e)}var n}(),s);return a&&a.then?a.then(function(e){return r?e:0}):r?a:0})})})}catch(e){return Promise.reject(e)}}},re=function(e){return function(t){try{return Promise.resolve(e.bringToFront()).then(function(){return Promise.resolve(z(e)).then(function(){return Promise.resolve(E(e,"Import account")).then(function(){return Promise.resolve(U(e,"your private key",t)).then(function(){return Promise.resolve(O(e,"Import")).then(function(){return Promise.resolve(J(e)).then(function(e){if(e)throw new SyntaxError(e)})})})})})})}catch(e){return Promise.reject(e)}}},oe=function(e){return function(){try{return Promise.resolve(e.bringToFront()).then(function(){return Promise.resolve(z(e)).then(function(){return Promise.resolve(O(e,"Lock")).then(function(){})})})}catch(e){return Promise.reject(e)}}},ie=function(e){return function(){try{return Promise.resolve(Q(e,function(e){try{return Promise.resolve(e.bringToFront()).then(function(){return Promise.resolve(e.reload()).then(function(){return Promise.resolve(e.waitForSelector("div")).then(function(){return Promise.resolve(e.locator(".signature-request-message__scroll-button")).then(function(t){return Promise.resolve(t.count()).then(function(n){return Promise.resolve(t.count()).then(function(t){function n(){return Promise.resolve(O(e,"Sign")).then(function(){})}var r=function(){if(t>=1)return Promise.resolve(e.click(".signature-request-message__scroll-button")).then(function(){})}();return r&&r.then?r.then(n):n()})})})})})})}catch(e){return Promise.reject(e)}})).then(function(){})}catch(e){return Promise.reject(e)}}},ue=function(e){return function(t){void 0===t&&(t="main");try{return Promise.resolve(e.bringToFront()).then(function(){return Promise.resolve(R(e)).then(function(){return Promise.resolve(e.waitForSelector(":nth-match(li.dropdown-menu-item, 2)")).then(function(){return Promise.resolve(e.evaluate(function(e){for(var t=document.querySelectorAll("li.dropdown-menu-item"),n=0;n<t.length;n++)if(t[n].innerText.toLowerCase().includes(e.toLowerCase()))return n;return 0},t)).then(function(t){return Promise.resolve(e.evaluate(function(e){return document.querySelectorAll("li.dropdown-menu-item > span")[e].innerText},t)).then(function(n){return Promise.resolve(e.$$("li.dropdown-menu-item")).then(function(r){return Promise.resolve(r[t].click()).then(function(){return Promise.resolve(e.waitForSelector("//*[text() = '"+n+"']")).then(function(){})})})})})})})})}catch(e){return Promise.reject(e)}}};const se="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function ce(e,t,n){if(!e.s){if(n instanceof le){if(!n.s)return void(n.o=ce.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(ce.bind(null,e,t),ce.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}var le=/*#__PURE__*/function(){function e(){}return e.prototype.then=function(t,n){var r=new e,o=this.s;if(o){var i=1&o?t:n;if(i){try{ce(r,1,i(this.v))}catch(e){ce(r,2,e)}return r}return this}return this.o=function(e){try{var o=e.v;1&e.s?ce(r,1,t?t(o):o):n?ce(r,1,n(o)):ce(r,2,o)}catch(e){ce(r,2,e)}},r},e}();function ae(e){return e instanceof le&&1&e.s}var fe=function(e){try{return Promise.resolve(e.getByTestId("onboarding-complete-done").click()).then(function(){return Promise.resolve(e.getByTestId("pin-extension-next").click()).then(function(){return Promise.resolve(e.getByTestId("pin-extension-done").click()).then(function(){})})})}catch(e){return Promise.reject(e)}},he=function(e,t){var n=t.password,r=void 0===n?"password1234":n;try{return Promise.resolve(e.getByTestId("create-password-new").fill(r)).then(function(){return Promise.resolve(e.getByTestId("create-password-confirm").fill(r)).then(function(){return Promise.resolve(e.getByTestId("create-password-terms").click()).then(function(){return Promise.resolve(e.getByTestId("create-password-import").click()).then(function(){})})})})}catch(e){return Promise.reject(e)}},me=function(e,t){var n=t.seed,r=void 0===n?"already turtle birth enroll since owner keep patch skirt drift any dinner":n;try{return Promise.resolve(e.getByTestId("onboarding-import-wallet").click()).then(function(){return Promise.resolve(e.getByTestId("metametrics-i-agree").click()).then(function(){function t(){return Promise.resolve(e.getByTestId("import-srp-confirm").click()).then(function(){})}var n=function(e,t,n){if("function"==typeof e[se]){var r,o,i,u=e[se]();if(function e(n){try{for(;!(r=u.next()).done;)if((n=t(r.value))&&n.then){if(!ae(n))return void n.then(e,i||(i=ce.bind(null,o=new le,2)));n=n.v}o?ce(o,1,n):o=n}catch(e){ce(o||(o=new le),2,e)}}(),u.return){var s=function(e){try{r.done||u.return()}catch(e){}return e};if(o&&o.then)return o.then(s,function(e){throw s(e)});s()}return o}if(!("length"in e))throw new TypeError("Object is not iterable");for(var c=[],l=0;l<e.length;l++)c.push(e[l]);return function(e,t,n){var r,o,i=-1;return function n(u){try{for(;++i<e.length;)if((u=t(i))&&u.then){if(!ae(u))return void u.then(n,o||(o=ce.bind(null,r=new le,2)));u=u.v}r?ce(r,1,u):r=u}catch(e){ce(r||(r=new le),2,e)}}(),r}(c,function(e){return t(c[e])})}(r.split(" ").entries(),function(t){return Promise.resolve(U(e,t[0]+1+".",t[1])).then(function(){})});return n&&n.then?n.then(t):t()})})}catch(e){return Promise.reject(e)}},ve=function(e){try{return Promise.resolve(R(e)).then(function(){return Promise.resolve(E(e,"Show/hide")).then(function(){return Promise.resolve(q(e,"Advanced gas controls")).then(function(){return Promise.resolve(q(e,"Show test networks")).then(function(){return Promise.resolve(G(e)).then(function(){return Promise.resolve(_(e)).then(function(){})})})})})})}catch(e){return Promise.reject(e)}},de=function(e){try{return Promise.resolve(new Promise(function(e){return setTimeout(e,1e3)})).then(function(){return Promise.resolve(e.locator(".popover-header__button").isVisible()).then(function(t){var n=function(){if(t)return Promise.resolve(e.$eval(".popover-header__button",function(e){return e.click()})).then(function(){})}();if(n&&n.then)return n.then(function(){})})})}catch(e){return Promise.reject(e)}},Pe=function(e){return function(t){void 0===t&&(t="password1234");try{return Promise.resolve(e.bringToFront()).then(function(){return Promise.resolve(e.getByTestId("unlock-password").fill(t)).then(function(){return Promise.resolve(e.getByTestId("unlock-submit").click()).then(function(){return Promise.resolve(de(e)).then(function(){})})})})}catch(e){return Promise.reject(e)}}};function pe(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}var ye="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function ge(e,t,n){if(!e.s){if(n instanceof we){if(!n.s)return void(n.o=ge.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(ge.bind(null,e,t),ge.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}var we=/*#__PURE__*/function(){function e(){}return e.prototype.then=function(t,n){var r=new e,o=this.s;if(o){var i=1&o?t:n;if(i){try{ge(r,1,i(this.v))}catch(e){ge(r,2,e)}return r}return this}return this.o=function(e){try{var o=e.v;1&e.s?ge(r,1,t?t(o):o):n?ge(r,1,n(o)):ge(r,2,o)}catch(e){ge(r,2,e)}},r},e}();function be(e){return e instanceof we&&1&e.s}var ke=function(e,t){var n=t.seed,r=void 0===n?"already turtle birth enroll since owner keep patch skirt drift any dinner":n,o=t.password,i=void 0===o?"password1234!!!!":o;try{return Promise.resolve(e.getByTestId("btn-import-existing-wallet").click()).then(function(){return Promise.resolve(e.getByTestId("btn-import-recovery-phrase").click()).then(function(){return Promise.resolve(e.getByTestId("seed-phrase-input").fill(r)).then(function(){return Promise.resolve(e.getByTestId("btn-import-wallet").click()).then(function(){return Promise.resolve(e.getByTestId("setPassword").fill(i)).then(function(){return Promise.resolve(e.getByTestId("setPasswordVerify").fill(i)).then(function(){return Promise.resolve(e.getByTestId("terms-and-privacy-policy").check()).then(function(){return Promise.resolve(e.getByTestId("btn-password-continue").click()).then(function(){return Promise.resolve(_(e)).then(function(){})})})})})})})})})}catch(e){return Promise.reject(e)}},Te=function(e){try{return Promise.resolve(e.getByTestId("portfolio-navigation-link").click()).then(function(){})}catch(e){return Promise.reject(e)}},je=function(e){try{return Promise.resolve(e.goto(e.url().split("?")[0])).then(function(){})}catch(e){return Promise.reject(e)}},Se=function(e){return function(){try{return Promise.resolve(Q(e,function(e){try{return Promise.resolve(e.getByTestId("allow-authorize-button").click()).then(function(){})}catch(e){return Promise.reject(e)}})).then(function(){})}catch(e){return Promise.reject(e)}}},Be=function(e){return function(){try{return Promise.resolve(Q(e,function(e){try{return Promise.resolve(e.getByTestId("sign-message").click()).then(function(){})}catch(e){return Promise.reject(e)}})).then(function(){})}catch(e){return Promise.reject(e)}}},Ie=function(e){return function(){try{return Promise.resolve(e.getByTestId("settings-navigation-link").click()).then(function(){return Promise.resolve(e.getByTestId("lock-wallet-button").click()).then(function(){})})}catch(e){return Promise.reject(e)}}},Fe=function(e){return function(t){void 0===t&&(t="password1234!!!!");try{return Promise.resolve(e.getByTestId("unlock-with-password").fill(t)).then(function(){return Promise.resolve(e.getByTestId("unlock-wallet-button").click()).then(function(){return Promise.resolve(Te(e)).then(function(){return Promise.resolve(e.waitForSelector("//div[@data-testid='asset-list']//*[not(text='')]",{timeout:1e4})).then(function(){})})})})}catch(e){return Promise.reject(e)}}},xe=function(e){return function(){try{return Promise.resolve(Q(e,function(e){try{var t=function(){return Promise.resolve(e.getByTestId("request-confirm-button").click()).then(function(){})},n=pe(function(){return Promise.resolve(e.waitForSelector("text='Got it'",{timeout:1e3})).then(function(e){return Promise.resolve(e.click()).then(function(){})})},function(){});return Promise.resolve(n&&n.then?n.then(t):t())}catch(e){return Promise.reject(e)}})).then(function(){})}catch(e){return Promise.reject(e)}}},Ae=function(e){return function(t){try{return Promise.resolve(e.context().newPage()).then(function(n){return Promise.resolve(n.goto(e.url()+"?internalPopUpRequest=true&action=addCustomNetwork")).then(function(){return Promise.resolve(n.getByTestId("custom-network-name-input").fill(t.networkName)).then(function(){return Promise.resolve(n.getByTestId("custom-network-rpc-url-input").fill(t.rpc)).then(function(){return Promise.resolve(n.getByTestId("custom-network-chain-id-input").fill(t.chainId.toString())).then(function(){return Promise.resolve(n.getByTestId("custom-network-currency-symbol-input").fill(t.symbol)).then(function(){return Promise.resolve(n.getByTestId("custom-network-save").click()).then(function(){function t(){function t(t){return Promise.resolve(n.waitForEvent("close")).then(function(){return Promise.resolve(e.bringToFront()).then(function(){return Promise.resolve(e.reload()).then(function(){})})})}var o=function(){if(r)return Promise.resolve(r.textContent()).then(function(e){return Promise.resolve(n.close()).then(function(){throw new SyntaxError(e)})})}();return o&&o.then?o.then(t):t()}var r,o=pe(function(){return Promise.resolve(n.waitForSelector('//span[@data-testid="text-input-error-label"]',{timeout:50})).then(function(e){r=e})},function(){});return o&&o.then?o.then(t):t()})})})})})})})}catch(e){return Promise.reject(e)}}},Ne=function(e){return function(t){try{return Promise.resolve(e.getByTestId("settings-navigation-link").click()).then(function(){return Promise.resolve(e.getByTestId("settings-networks-menu-cell-pressable").click()).then(function(){return Promise.resolve(e.getByTestId("network-list-search").fill(t)).then(function(){return Promise.resolve(e.waitForSelector('//div[@data-testid="list-"][1]//button')).then(function(t){return Promise.resolve(t.click()).then(function(){return Promise.resolve(e.getByTestId("custom-network-delete").click()).then(function(){return Promise.resolve(Te(e)).then(function(){})})})})})})})}catch(e){return Promise.reject(e)}}},Ce=function(e){return function(t){try{return Promise.resolve(e.getByTestId("settings-navigation-link").click()).then(function(){return Promise.resolve(e.getByTestId("settings-networks-menu-cell-pressable").click()).then(function(){return Promise.resolve(e.getByTestId("network-list-search").fill(t)).then(function(){return Promise.resolve(e.isVisible('//div[@data-testid="list-"][1]//button')).then(function(t){return Promise.resolve(Te(e)).then(function(){return t})})})})})}catch(e){return Promise.reject(e)}}},_e=function(e){return function(t){try{var n,r=function(){return n?Promise.resolve(n.textContent()).then(function(e){var n=e.replaceAll(/ |,/g,"").split(t)[2];return n?Number(n):0}):0},o=function(e,t,n){if("function"==typeof e[ye]){var r,o,i,u=e[ye]();if(function e(n){try{for(;!(r=u.next()).done;)if((n=t(r.value))&&n.then){if(!be(n))return void n.then(e,i||(i=ge.bind(null,o=new we,2)));n=n.v}o?ge(o,1,n):o=n}catch(e){ge(o||(o=new we),2,e)}}(),u.return){var s=function(e){try{r.done||u.return()}catch(e){}return e};if(o&&o.then)return o.then(s,function(e){throw s(e)});s()}return o}if(!("length"in e))throw new TypeError("Object is not iterable");for(var c=[],l=0;l<e.length;l++)c.push(e[l]);return function(e,t,n){var r,o,i=-1;return function n(u){try{for(;++i<e.length;)if((u=t(i))&&u.then){if(!be(u))return void u.then(n,o||(o=ge.bind(null,r=new we,2)));u=u.v}r?ge(r,1,u):r=u}catch(e){ge(r||(r=new we),2,e)}}(),r}(c,function(e){return t(c[e])})}([function(){try{return Promise.resolve(e.bringToFront()).then(function(){return Promise.resolve(e.getByTestId("portfolio-selector-nav-tabLabel--crypto").click()).then(function(){return Promise.resolve(e.waitForSelector('//button[contains(@data-testid, "asset-item")][contains(@data-testid, "'+t+'")]',{timeout:500}))})})}catch(e){return Promise.reject(e)}},function(){try{return Promise.resolve(e.getByTestId("portfolio-selector-nav-tabLabel--testnet").click()).then(function(){return Promise.resolve(e.waitForSelector('//button[contains(@data-testid, "asset-item")][contains(@data-testid, "'+t+'")]',{timeout:500}))})}catch(e){return Promise.reject(e)}}],function(e){var t=pe(function(){return Promise.resolve(e()).then(function(e){n=e})},function(){});if(t&&t.then)return t.then(function(){})});return Promise.resolve(o&&o.then?o.then(r):r())}catch(e){return Promise.reject(e)}}},Ee=function(e){return function(){try{return Promise.resolve(e.getByTestId("portfolio-header--switcher-cell-pressable").click()).then(function(){return Promise.resolve(e.getByTestId("wallet-switcher--manage").click()).then(function(){return Promise.resolve(e.getByTestId("manage-wallets-account-item--action-cell-pressable").click()).then(function(){function t(){return Promise.resolve(_(e)).then(function(){})}var n=pe(function(){return Promise.resolve(e.getByTestId("add-new-wallet--continue").click()).then(function(){})},function(){});return n&&n.then?n.then(t):t()})})})}catch(e){return Promise.reject(e)}}},Oe=function(e){return function(t){try{return Promise.resolve(e.getByTestId("portfolio-header--switcher-cell-pressable").click()).then(function(){return Promise.resolve(e.waitForSelector('(//button[@data-testid="wallet-switcher--wallet-item-cell-pressable"])['+t+"]")).then(function(e){return Promise.resolve(e.click()).then(function(){})})})}catch(e){return Promise.reject(e)}}},Ue=function(e){try{return console.warn("deleteAccount not implemented - Coinbase does not support importing/removing additional private keys"),Promise.resolve()}catch(e){return Promise.reject(e)}},Ve=function(e){try{return console.warn("addToken not implemented - Coinbase does not support adding custom tokens"),Promise.resolve()}catch(e){return Promise.reject(e)}},Le=function(e){try{return console.warn("importPK not implemented - Coinbase does not support importing/removing private keys"),Promise.resolve()}catch(e){return Promise.reject(e)}},qe=function(e){try{return console.warn("switchNetwork not implemented"),Promise.resolve()}catch(e){return Promise.reject(e)}},Re=function(){try{return console.warn("confirmNetorkSwitch not implemented"),Promise.resolve()}catch(e){return Promise.reject(e)}},ze=/*#__PURE__*/function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).options=void 0,t.defaultSetupSteps=[ke,je],t.setup=j(t.page,t.defaultSetupSteps),t.addNetwork=Ae(t.page),t.addToken=Ve,t.approve=Se(t.page),t.createAccount=Ee(t.page),t.confirmNetworkSwitch=Re,t.confirmTransaction=xe(t.page),t.deleteAccount=Ue,t.deleteNetwork=Ne(t.page),t.getTokenBalance=_e(t.page),t.hasNetwork=Ce(t.page),t.importPK=Le,t.lock=Ie(t.page),t.sign=Be(t.page),t.switchAccount=Oe(t.page),t.switchNetwork=qe,t.unlock=Fe(t.page),t}return d(t,e),t}(C);ze.id="coinbase",ze.recommendedVersion="3.6.0",ze.releasesUrl="https://api.github.com/repos/TenKeyLabs/coinbase-wallet-archive/releases",ze.homePath="/index.html",ze.download=I(ze.id,ze.releasesUrl,ze.recommendedVersion);var Ge=function(e){return function(){try{return Promise.resolve(Q(e,function(t){try{return Promise.resolve(O(t,"Switch network")).then(function(){return Promise.resolve(_(e)).then(function(){})})}catch(e){return Promise.reject(e)}})).then(function(){})}catch(e){return Promise.reject(e)}}},We=function(e){return function(t){try{return Promise.resolve(e.bringToFront()).then(function(){return Promise.resolve(R(e)).then(function(){return Promise.resolve(e.isVisible('//div[@class="network-dropdown-list"]/li[contains(string(), "'+t+'")]')).then(function(t){return Promise.resolve(e.waitForSelector(".network-display")).then(function(e){return e.click(),t})})})})}catch(e){return Promise.reject(e)}}},Je=/*#__PURE__*/function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).options=void 0,t.defaultSetupSteps=[me,he,fe,de,ve],t.setup=j(t.page,t.defaultSetupSteps),t.addNetwork=K(t.page),t.addToken=D(t.page),t.approve=M(t.page),t.createAccount=X(t.page),t.confirmNetworkSwitch=Ge(t.page),t.confirmTransaction=Z(t.page),t.deleteAccount=H(t.page),t.deleteNetwork=Y(t.page),t.getTokenBalance=ne(t.page),t.hasNetwork=We(t.page),t.importPK=re(t.page),t.lock=oe(t.page),t.sign=ie(t.page),t.switchAccount=$(t.page),t.switchNetwork=ue(t.page),t.unlock=Pe(t.page),t}return d(t,e),t}(C);Je.id="metamask",Je.recommendedVersion="10.25.0",Je.releasesUrl="https://api.github.com/repos/metamask/metamask-extension/releases",Je.homePath="/home.html",Je.download=I(Je.id,Je.releasesUrl,Je.recommendedVersion);var Ke=[ze,Je],De=function(e){var t=Ke.find(function(t){return t.id===e});if(!t)throw new Error("Wallet "+e+" not supported");return t},Qe=function(e,t){try{var n,r=function(e){if(n)return e;var r=t.pages()[1];return new o(r)},o=De(e),i=function(){if(1===t.pages().length){var e,r=function(t){if(n)return t;var r=new o(e);return n=1,r},i=function(r,i){try{var u=Promise.resolve(t.waitForEvent("page",{timeout:2e3})).then(function(t){var r=new o(e=t);return n=1,r})}catch(e){return i()}return u&&u.then?u.then(void 0,i):u}(0,function(){return Promise.resolve(t.newPage()).then(function(t){return e=t,Promise.resolve(e.goto("chrome-extension://gadekpdjmpjjnnemgnhkbjgnjpdaakgh"+o.homePath)).then(function(){})})});return i&&i.then?i.then(r):r(i)}}();return Promise.resolve(i&&i.then?i.then(r):r(i))}catch(e){return Promise.reject(e)}},Me=["headless"],Ze=function(e,t){try{var n=t.headless,r=p(t,Me),o=De(r.wallet);if(!o)throw new Error("Wallet not supported");return Promise.resolve(o.download(r)).then(function(e){return Promise.resolve(m.default.chromium.launchPersistentContext(a.join(Xe,r.wallet),{headless:null!=n&&n,viewport:null,args:["--disable-extensions-except="+e,"--load-extension="+e,"--start-maximized"]})).then(function(e){return Promise.resolve(Qe(o.id,e)).then(function(t){return{wallet:t,browserContext:e}})})})}catch(e){return Promise.reject(e)}},Xe=a.resolve(h.default.tmpdir(),"dappwright","session"),$e=["seed","password","showTestNets"];exports.CoinbaseWallet=ze,exports.MetaMaskWallet=Je,exports.bootstrap=function(e,t){var n=t.seed,r=t.password,o=t.showTestNets,i=p(t,$e);try{return l.default.existsSync(a.join(Xe,i.wallet))&&l.default.rmdirSync(a.join(Xe,i.wallet),{recursive:!0}),Promise.resolve(Ze(0,i)).then(function(e){var t=e.browserContext;return function(e,u){try{var s=Promise.resolve(Qe(i.wallet,t)).then(function(e){return Promise.resolve(e.setup({seed:n,password:r,showTestNets:o})).then(function(){return[e,e.page,t]})})}catch(e){return u(e)}return s&&s.then?s.then(void 0,u):s}(0,function(e){return Promise.resolve(t.close()).then(function(){throw e})})})}catch(e){return Promise.reject(e)}},exports.getWallet=Qe,exports.launch=Ze,exports.sessionPath=Xe,exports.setup=j;
//# sourceMappingURL=index.js.map
